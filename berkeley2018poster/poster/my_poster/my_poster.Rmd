---
title: "**pegax:** Fast Taxonomic Name Parsing in R"
output: 
  postr::flex_dashboard_poster:
    render_print: true
---

<style>
  body {
    padding-top:0px
  }
  .navbar{
    visibility: hidden
  }
</style>


## Header row {data-height=7}

###

<table style="width:100%">
<tr>
  <td>
    <center>
      <h2>**pegax: Fast Taxonomic Name Parsing in R**</h2>
    </center>
  </td>
  <td rowspan="2">
    <img src="resources/logo.svg" style="width:158px"></img>
  </td>
</tr>
<tr>
  <td><center>**Scott Chamberlain** <br> **rOpenSci / UC Berkeley**</center></td>
</tr>
</table> 

## Body row {data-height=93}

### 

#### **Introduction**

Nearly all biologists work with taxonomic names; taxonomic names are messy. Parsing taxonomic names into their components is often a first step.

Global Names project (http://globalnames.org/) is a huge advance. However, Global Names is available via a web service (internet speed dependent) and in programming languages (Java/Go) that don't play nice with R. 

Many biologists work in the R language. We need really fast and dependency free R tooling to work with taxonomic names.

Learning from Global Names, `pegax` (https://github.com/ropenscilabs/pegax) is a new R package that implements a Parsing Expression Grammar (PEG) for taxonomic names.


#### **Parsing Expression Grammars**

Parsing Expression Grammars, or PEGs, describe a formal language about how to recognize strings in a set of text.

For example, capture any letter

```
struct name : plus< alpha > {};
```

capture any digit

```
struct numbers : plus< digit > {};
```

Rules are combined to form a grammar, e.g., string must match `name`, then have one comma, then one space, then match `numbers`.

```
struct grammar
  : must< name, one< ',' >, space, numbers, eof >
{};
```

Which is then applied to parsing user input strings


### 

#### **pegax package**

GitHub: <https://github.com/ropenscilabs/pegax>

#### **Installation**

```r
remotes::install_github("ropenscilabs/pegax")
library(pegax)
```

#### **Examples**

```r
# Author name
pgx_authority_names("Linnaeus, 1758")
#> [1] "Linnaeus"

# Author year
pgx_authority_years("Linnaeus, 1758")
#> [1] "1758"

# Parse ranks
pgx_ranks("Fagus sylvatica subsp. orientalis")
#> [1] "subsp."

# Many ranks at cone
pgx_ranks(c("Helianthus annuus var. annuus",
   "Helianthus annuus ssp. annuus", "Caulerpa cupressoides forma nuda"))
#> [1] "var."   "ssp."   "forma."
```

### 

#### **benchmark: it's pretty fast**

```{r eval = FALSE, echo = TRUE}
library(microbenchmark)
library(charlatan)
per <- charlatan::PersonProvider$new()
date <- charlatan::DateTimeProvider$new()
x <- replicate(10^4, paste( # 10,000 name/year strings
    sample(per$person$last_names, 1),
    date$year(),
    sep = ", "))
# years
system.time(pgx_authority_years(x)) # 0.025 sec
# names
system.time(pgx_authority_names(x)) # 0.023 sec
```

#### **future work**

* Full name parsing, parity with Global Names parser
* R DSL to make custom PEGS for taxonomy

```r
pegax(plus(alpha), one(,), numbers(,))
```

#### **Use cases**

* foo
* bar

#### **Conclusion**

asfafasfsdf
